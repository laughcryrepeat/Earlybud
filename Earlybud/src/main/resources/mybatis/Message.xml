<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.earlybud.vo.MessageVO">
<!--   	<resultMap type="Message" id="MessageMap">dto mapping -->
<!--   		<result property="message_code" column="MESSAGE_CODE"/> -->
<!--   		<result property="item_code" column="ITEM_CODE"/> -->
<!--   		<result property="receiver" column="RECEIVER"/> -->
<!--   		<result property="sender" column="SENDER"/> -->
<!--   		<result property="content" column="CONTENT"/> -->
<!--   		<result property="send_date" column="SEND_DATE"/> -->
<!--   		<result property="read_check" column="READ_CHECK"/> -->
<!--   	</resultMap> -->
  	
<!--   	<select id="listMessage" resultType="Message" parameterType="String"> -->
<!--   	select * from message where receiver = #{email} -->
<!--   	</select> -->
  	
<!--   	<select id="listSentMessage" resultType="Message" parameterType="String"> -->
<!--   	select * from message where sender = #{email} -->
<!--   	</select> -->
  	
<!--   	<insert id="sendMessage" parameterType="Message"> -->
<!--   	insert into message(message_code,item_code,receiver,sender,content,send_date,read_check)  -->
<!--   	values(MESSAGE_CODE_SEQ.nextval,#{item_code},#{receiver},#{sender},#{content},sysdate,0)  -->
<!--   	</insert> -->
  	
<!--   	<update id="updateRead" parameterType="Integer"> -->
<!--   	update message set read_check = 1 where message_code =#{message_code} -->
<!--   	</update> -->
  	
<!--   	<delete id="deleteMessage" parameterType="String"> -->
<!--   	delete from message where email = #{email} -->
<!--   	</delete> -->
	<select id="getMessageList" resultType="com.earlybud.vo.MessageVO"><!-- 좋아요한 아이템들 목록 불러오기 -->
  		SELECT
  		ITEM.main_image, ITEM.title, MEMBER.nickname, CATEGORY.cat_name, ITEM.target_sum, ITEM.cur_sum, TRUNC((CUR_SUM/TARGET_SUM)*100, 0) as PERCENT, ITEM.summary,
  		TRUNC(SYSDATE-ITEM.CLOSINGDATE,0) as TIME, TO_CHAR(ITEM.CUR_SUM, '999,999,999,999') as NOW_SUM
		FROM LIKES
		LEFT OUTER JOIN ITEM on LIKES.item_code=ITEM.item_code
		LEFT OUTER JOIN MEMBER on ITEM.EMAIL=MEMBER.EMAIL
		LEFT OUTER JOIN CATEGORY on ITEM.cat_code = CATEGORY.cat_code
		where ITEM.item_code = 48
  	</select>

  	
  </mapper>