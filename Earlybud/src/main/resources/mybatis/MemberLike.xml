<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.earlybud.vo.MemberLikeVO">
<!--   	<resultMap type="MemberLike" id="memberLikeMap">dto mapping -->
<!-- not used. property ex <result property="email" column="EMAIL"/> -->
<!--   		<collection property="itemList" resultMap="itemMap"></collection> -->
<!--   		<collection property="sellerList" resultMap="sellerMap"></collection> -->
<!--   		<collection property="likeList" resultMap="likeMap"></collection> -->
<!--   	</resultMap> -->
  	
<!--   	<resultMap type="Items" id="itemMap"> -->
<!--     	<result property="main_image" column="MAIN_IMAGE"/> -->
<!--     	<result property="title" column="TITLE"/> -->
<!--     	<result property="nickname" column="NICKNAME"/> -->
<!--     	<result property="cat_name" column="CAT_NAME"/> -->
<!--     	<result property="target_sum" column="TARGET_SUM"/> -->
<!--     	<result property="cur_sum" column="CUR_SUM"/> -->
<!--  	</resultMap> -->
 	
<!--  	<resultMap type="Sellers" id="sellerMap"> -->
<!--  		<result property="image" column="IMAGE"/> -->
<!--  		<result property="nickname" column="NICKNAME"/> -->
<!--   	</resultMap> -->
  	
<!--   	<resultMap type="LikeList" id="likeListMap"> -->
<!--   		<result property="email" column = "EMAIL"/> -->
<!--   		<result property="item_code" column = "ITEM_CODE"/> -->
<!--   		<result property="seller_email" column="SELLER_EMAIL"/>	 -->
<!--   	</resultMap> -->

  	<select id="readItemLiked" resultType="com.earlybud.vo.MemberLikeVO"><!-- 좋아요한 아이템들 목록 불러오기 -->
  		SELECT
  		ITEM.main_image, ITEM.title, MEMBER.nickname, CATEGORY.cat_name, ITEM.target_sum, ITEM.cur_sum, TRUNC((CUR_SUM/TARGET_SUM)*100, 0) as PERCENT, ITEM.summary,
  		TRUNC(SYSDATE-ITEM.CLOSINGDATE,0) as TIME, TO_CHAR(ITEM.CUR_SUM, '999,999,999,999') as NOW_SUM
		FROM LIKES
		LEFT OUTER JOIN ITEM on LIKES.item_code=ITEM.item_code
		LEFT OUTER JOIN MEMBER on ITEM.EMAIL=MEMBER.EMAIL
		LEFT OUTER JOIN CATEGORY on ITEM.cat_code = CATEGORY.cat_code
		where ITEM.item_code = 48
  	</select>
  	
  
  	
<!--   	<insert id="insertItemLiked" parameterMap="likeListMap"> -->
<!--   		INSERT into LIKES(EMAIL, ITEM_CODE) -->
<!--   		values(#{email}, #{item_code}) -->
<!--   	</insert> -->
  	
 
  	
  	<delete id="deleteItemLiked">
  		delete LIKES
  		where email = #{email} and item_code = #{item_code}
  	</delete>
  	
	 <select id="readOneSellerItem" resultType="com.earlybud.vo.MemberLikeVO"><!-- 좋아요한 아이템들 목록 불러오기 -->
  		SELECT
  		ITEM.email, ITEM.main_image, ITEM.title, MEMBER.nickname, ITEM.target_sum, ITEM.cur_sum, ITEM.summary, ITEM.closingdate, SELLER.image, SELLER.info,
  		TRUNC(SYSDATE-ITEM.CLOSINGDATE,0) as TIME, TO_CHAR(ITEM.CUR_SUM, '999,999,999,999') as NOW_SUM, TRUNC((CUR_SUM/TARGET_SUM)*100, 0) as PERCENT
		FROM ITEM
		LEFT OUTER JOIN MEMBER on ITEM.EMAIL=MEMBER.EMAIL
		LEFT OUTER JOIN SELLER on MEMBER.EMAIL=SELLER.EMAIL
		where ITEM.email = #{email}
  	</select>
<!--   	<select id="read" resultMap="memberMap"> -->
<!--   	SELECT  -->
<!--   	mem.email, pwd, nickname, phone, addr, detail_addr, joindate, dropdate, item_liked, authority  -->
<!--   	FROM  -->
<!--   	member mem LEFT OUTER JOIN authorities auth on mem.email = auth.email  -->
<!--   	WHERE mem.email = #{email}  -->
<!--   	</select> -->
  	
<!--   	<select id="listMember" resultMap="memberMap"> -->
<!--   	SELECT  -->
<!--   	mem.email, nickname, phone, addr, detail_addr, joindate, dropdate, item_liked, authority  -->
<!--   	FROM  -->
<!--   	member mem LEFT OUTER JOIN authorities auth on mem.email = auth.email  -->
<!--   	</select> -->
  	
<!--   	<delete id="deleteMember" parameterType="String"> -->
<!--   	delete from member where email = #{email} -->
<!--   	</delete> -->
  	
  </mapper>